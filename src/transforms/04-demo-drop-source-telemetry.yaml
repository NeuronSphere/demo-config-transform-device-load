type: provider
query_config:
  query_name: by_transform_name_dependent_transform
  query_value:
    dep_tf_name: 03-demo-staging-to-final-telemetry
    tf_name: 04-demo-drop-source-telemetry
config:
    provider_package: hmd_operators.trino
    provider_class: TrinoOperator
    params:
        sql: |
            DROP TABLE IF EXISTS demo_source.telemetry_{{ ns_context['table_suffix'].replace('-', '_') }}
        trino_conn_id: trino_conn_overwrite
        autocommit: true
    run_params:
        table_suffix: "{source_path[1]}_{source_path[2]}_{source_path[3]}"